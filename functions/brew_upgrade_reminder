#!/bin/bash

brew_upgrade_reminder() {
  local threshold_days=14
  local hist_file="$HOME/.zsh_history"
  local last_ts

  # Extract last timestamp from zsh history for brewup
  last_ts=$(grep ';brewup' "$hist_file" | tail -n1 | awk -F':' '{print $2}')

  if [[ -n "$last_ts" ]]; then
    local last_date
    local days_since

    last_date=$(date -r "$last_ts" +"%Y-%m-%d")
    days_since=$(( ( $(date +%s) - last_ts ) / 86400 ))

    echo "🧃 Last 'brewup' was on $last_date ($days_since days ago)."

    if (( days_since > threshold_days )); then
      echo "🔔 It's been over $threshold_days days — time to run: brewup"
    fi
  else
    echo "⚠️  No 'brewup' command found in your zsh history."
  fi
}
