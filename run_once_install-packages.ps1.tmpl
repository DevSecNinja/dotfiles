# PowerShell script to install common development tools on Windows
# Uses winget (modern, built-in) as primary package manager
# For light servers, only installs essential tools
# For full installation, installs complete development toolset

$ErrorActionPreference = "Stop"

Write-Host "Installing development tools ({{ .installType }} mode)..." -ForegroundColor Cyan

# Check if winget is available (Windows 10 1809+ with App Installer)
$useWinget = $null -ne (Get-Command winget -ErrorAction SilentlyContinue)

if (-not $useWinget) {
    Write-Error "winget not found."
    exit 1
}

# Refresh environment variables to ensure packages are in PATH
$machinePath = [System.Environment]::GetEnvironmentVariable("Path", "Machine")
$userPath = [System.Environment]::GetEnvironmentVariable("Path", "User")

if ($machinePath -and $userPath) {
    $env:Path = $machinePath + ";" + $userPath
}
elseif ($machinePath) {
    $env:Path = $machinePath
}
else {
    Write-Error "Failed to retrieve system PATH."
    exit 1
}
