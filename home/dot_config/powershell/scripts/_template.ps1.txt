#Requires -Version 5.1
<#
.SYNOPSIS
    Brief description of what this script does.

.DESCRIPTION
    Detailed description of the script's purpose and behavior.
    Add more context about when and how to use this script.

.PARAMETER ParameterName
    Description of the parameter.

.PARAMETER DryRun
    Show what would be changed without making changes.

.PARAMETER Verbose
    Enable verbose output (built-in common parameter).

.EXAMPLE
    .\ScriptName.ps1
    Run with default options.

.EXAMPLE
    .\ScriptName.ps1 -DryRun
    Preview changes without executing.

.EXAMPLE
    .\ScriptName.ps1 -ParameterName "value" -Verbose
    Run with verbose output and a parameter.

.NOTES
    - Add any important notes or warnings here
    - Mention dependencies or requirements
    - Scripts must be idempotent (safe to run multiple times)
#>

#region Setup
[CmdletBinding(SupportsShouldProcess)]
param(
    [Parameter(Mandatory = $false, HelpMessage = "Description of the parameter")]
    [string]$ParameterName,

    [Parameter(Mandatory = $false, HelpMessage = "Show what would be changed without making changes")]
    [switch]$DryRun
)

# Set strict mode for error handling
$ErrorActionPreference = "Stop"
#endregion Setup

#region Validation
# Check for required commands
# if (-not (Get-Command "required-command" -ErrorAction SilentlyContinue)) {
#     Write-Error "Required command 'required-command' is not installed or not in PATH"
#     Exit 1
# }

# Validate parameters
# if ([string]::IsNullOrWhiteSpace($ParameterName)) {
#     Write-Error "ParameterName cannot be empty"
#     Exit 1
# }
#endregion Validation

#region Functions
# Helper functions go here
# function Get-SomeData {
#     [CmdletBinding()]
#     param(
#         [Parameter(Mandatory = $true)]
#         [string]$InputValue
#     )
#
#     # Function logic here
#     return $result
# }
#endregion Functions

#region Dry Run Check
if ($DryRun) {
    Write-Host "[DRY RUN] Would perform the following actions:" -ForegroundColor Cyan
    Write-Host "   - Action 1 would be performed"
    Write-Host "   - Action 2 would be performed"
    Exit 0
}
#endregion Dry Run Check

#region Main Execution
Write-Verbose "Running ScriptName..."

# Replace this section with your script's main logic

# Example: Perform some action with ShouldProcess support
# $targetResource = "example-resource"
# if ($PSCmdlet.ShouldProcess($targetResource, "Perform action")) {
#     try {
#         # Action here
#         Write-Host "[OK] Successfully completed action" -ForegroundColor Green
#     }
#     catch {
#         Write-Warning "Failed to complete action: $_"
#         Exit 1
#     }
# }

# Example: Simple operation
# try {
#     # Perform operation
#     Write-Verbose "Performing operation..."
#     # Operation code here
# }
# catch {
#     Write-Error "Operation failed: $_"
#     Exit 1
# }

Write-Host "[OK] ScriptName completed successfully" -ForegroundColor Green
#endregion Main Execution
